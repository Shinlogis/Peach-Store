<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="Admin">

    <resultMap id="AdminMap" type="peachstore.domain.Admin">
        <id property="adminId" column="admin_id"/>
        <result property="email" column="email"/>
        <result property="password" column="password"/>
        <result property="salt" column="salt"/>
        <result property="adminName" column="admin_name"/>
        <result property="role" column="role"/>
        <result property="isActive" column="is_active"/>
    </resultMap>

	<!-- 전체 조회 -->
	<select id="selectAll" resultMap="AdminMap">
		select *
		from admin
	</select>
		
	<!-- pk로 조회 -->
	<select id="selectById" parameterType="int" resultMap="AdminMap">
		select *
		from admin
		where admin_id = #{value}
	</select>
	
	 <!-- 로그인용 조회 -->
	<select id="selectByLogin" parameterType="map" resultMap="AdminMap">
		select * from admin
		where email = #{email}
	</select>
	
	 <!-- 추가: 관리자 등록 -->
    <insert id="insertAdmin" parameterType="peachstore.domain.Admin">
        INSERT INTO admin (email, password, salt, admin_name, role, is_active)
        VALUES (#{email}, #{password}, #{salt}, #{adminName}, #{role}, #{isActive})
    </insert>

    <!-- 추가: 비밀번호 변경 -->
    <update id="updatePassword" parameterType="map">
        UPDATE admin
        SET password = #{password}, salt = #{salt}
        WHERE admin_id = #{adminId}
    </update>

    <!-- 추가: 상태(활성/비활성) 변경 -->
    <update id="updateIsActive" parameterType="map">
        UPDATE admin
        SET is_active = #{isActive}
        WHERE admin_id = #{adminId}
    </update>

    <!-- 추가: 관리자 정보 수정 -->
    <update id="updateAdminInfo" parameterType="peachstore.domain.Admin">
        UPDATE admin
        SET admin_name = #{adminName}, role = #{role}
        WHERE admin_id = #{adminId}
    </update>
    
    <!-- 이메일로 관리자 단건 조회 (중복 체크) -->
	<select id="selectAdminByEmail" parameterType="string" resultMap="AdminMap">
	    SELECT *
	    FROM admin
	    WHERE email = #{email}
	</select>
</mapper>


