<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="CartItem">

	<resultMap type="CartItem" id="selectCartItemByCartId">
		<id column="cart_item_id" property="cart_item_id"/>
		<result column="quantity" property="quantity"/>
		<association column="custom_option_id" property="custom_option" javaType="CustomOption"
			select="CustomOption.selectAll"/>
		<association column="cart_id" property="cart" javaType="Cart"
    		select="Cart.selectById"/>
		<association column="product_id" property="product" javaType="Product"
			select="Product.select"/>
	</resultMap>

	<insert id="insert" parameterType="Cart">
		insert into cart_item(cart_id, product_id, custom_option_id, quantity)
		values(#{cart.cart_id},#{product.product_id},#{custom_option_id},#{quantity})
	</insert>
	
	<select id="selectCartItemByCartIsd" resultMap="selectCartItemByCartId">
		select * from cart_item where cart_id = #{cart_id}
	</select>
	
	<select id="selectCartItemByCartId" parameterType="int" resultType="CartItem">
		SELECT *
		FROM cart_item ci
		LEFT JOIN custom_option co ON ci.custom_option_id = co.custom_option_id
		LEFT JOIN cart c ON ci.cart_id = c.cart_id
		LEFT JOIN product p ON ci.product_id = p.product_id
		WHERE ci.cart_id = #{cart_id};
	</select>
	
</mapper>